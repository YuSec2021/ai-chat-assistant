------  
name: 每次对话自动生成更新意图Todo清单  
descriptions: 在每次Claude Code（CC）对话开始时自动触发。读取用户本次的主要意图后，立即创建一份结构化的todo清单文件，用于记录本次对话/功能更新的待办事项。文件统一放在 docs/updates/todo/ 目录下（若目录不存在则自动创建），文件名格式为：YYYY-MM-DD_简短意图描述.md。该技能为“前置守护技能”，主要作用是建立可追溯的更新日志习惯。  

------

# 具体能力及执行流程

1. **判断是否为新对话 / 是否需要触发**  
   - 如果这是本次会话的**第一条用户消息**（或非常明确是新功能需求、新任务开始），则认定为需要生成todo的时机  
   - 如果用户消息明显是继续上一轮的细化、修bug、补充说明，则**跳过**本技能（避免重复生成）

2. **提取本次对话的核心意图（一句话概括）**  
   - 分析用户第一条（或当前主要）消息  
   - 提炼出简短、具区分度的更新意图描述（10个汉字以内为佳）  
   - 示例：  
     - “新增商品搜索与筛选”  
     - “修复支付回调幂等性”  
     - “重构用户中心路由守卫”  
     - “添加会员等级权益展示”

3. **生成文件名**  
   - 格式：`YYYY-MM-DD_意图描述.md`  
   - 示例：  
     - 2025-08-14_新增商品搜索与筛选.md  
     - 2025-08-15_修复购物车数量同步问题.md  
   - 意图描述中禁止使用斜杠 /、反斜杠 \、冒号 : 等非法文件名字符，如有则替换成下划线或删除

4. **检查并创建目录（如果需要）**  
   执行类似以下命令（伪代码，实际由你根据当时环境选择最合适的写法）：  
   ```bash
   mkdir -p docs/updates/todo
   ```

5. **生成todo文件内容**  
   文件头部必须包含以下结构（后续可追加）：

   ```markdown
   # 更新意图  
   {一句话核心意图}

   # 创建时间  
   {当前年-月-日 时:分}

   # 当前对话目标  
   {把用户主要需求用更结构化的语言复述一遍}

   # Todo 清单（本次计划完成项）

   - [ ] 核心功能点1  
   - [ ] 核心功能点2  
   - [ ] 边界情况处理  
   - [ ] 错误处理与提示文案  
   - [ ] 自测要点 / 验收标准  
   - [ ] 需要确认/询问用户的事项

   # 备注 / 后续可能扩展的方向
   （可选）
   ```

6. **实际创建文件**  
   - 使用项目中已有的文件写入方式（例如你常用的 createFile、writeFile、fs.writeFileSync 等）  
   - 路径：`docs/updates/todo/{filename}`  
   - 如果同名文件已存在，则**在文件名后加 -v2、-v3**（或在文件内容里追加本次todo，不要覆盖）

7. **向用户通报执行结果**  
   在思考过程或直接回复中告知用户：  
   ```
   已为本次功能更新创建 todo 清单：
   → docs/updates/todo/2025-08-14_新增商品搜索与筛选.md
   正在按此清单逐步推进…
   ```

8. **后续对话中持续更新该文件（可选增强）**  
   - 当完成某项、发现新子任务、需要用户确认时，可主动在该文件中追加内容（使用追加模式而非覆盖）  
   - 完成后可在文件末尾添加完成时间与总结

执行优先级：**最高优先级前置技能**（应在几乎所有其他技能之前运行，用于建立本次变更的可追溯记录）。  
如果用户明确说“不要生成todo”或“今天不记录”，则本次跳过。